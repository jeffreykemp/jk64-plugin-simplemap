function jk64plugin_geocode(e,o){o.geocode({address:$v(e.geocodeItem),componentRestrictions:""!==e.country?{country:e.country}:{}},function(o,a){if(a==google.maps.GeocoderStatus.OK){apex.debug(e.regionId+" geocode ok");var n=o[0].geometry.location;jk64plugin_setMarker(e,n.lat(),n.lng()),""!==e.syncItem&&$s(e.syncItem,n.lat()+","+n.lng())}else apex.debug(e.regionId+" geocode was unsuccessful for the following reason: "+a)})}function jk64plugin_setMarker(e,o,a){if(null!==o&&null!==a){var n=e.marker?e.marker.getPosition():new google.maps.LatLng(0,0);if(o==n.lat()&&a==n.lng())apex.debug(e.regionId+" marker not changed");else{apex.debug(e.regionId+" move marker");var t=new google.maps.LatLng(o,a);e.map.panTo(t),e.markerZoom&&e.map.setZoom(e.markerZoom),e.marker?(e.marker.setMap(e.map),e.marker.setPosition(t)):e.marker=new google.maps.Marker({map:e.map,position:t,icon:e.icon})}}else e.marker&&(apex.debug(e.regionId+" remove marker"),e.marker.setMap(null))}function jk64plugin_getAddress(e,o,a){var n={lat:o,lng:a};e.geocoder.geocode({location:n},function(o,a){if(a===google.maps.GeocoderStatus.OK){for(i=0;i<o.length;i++)apex.debug(e.regionId+" result["+i+"]="+o[i].formatted_address+" ("+o[i].types.join()+")");o[1]?$s(e.addressItem,o[0].formatted_address):window.alert("Insufficient results found")}else a===google.maps.GeocoderStatus.ZERO_RESULTS?window.alert("No results found"):window.alert("Geocoder failed due to: "+a)})}function jk64plugin_initMap(e){var o={zoom:e.initZoom,center:new google.maps.LatLng(e.initLat,e.initLng),mapTypeId:google.maps.MapTypeId.ROADMAP};if(e.map=new google.maps.Map(document.getElementById(e.container),o),e.mapstyle&&e.map.setOptions({styles:e.mapstyle}),""!==e.syncItem){var a=$v(e.syncItem);if(null!==a&&a.indexOf(",")>-1){var n=a.split(",");jk64plugin_setMarker(e,n[0],n[1])}$("#"+e.syncItem).change(function(){var o=this.value;if(null!==o&&void 0!==o&&o.indexOf(",")>-1){var a=o.split(",");jk64plugin_setMarker(e,a[0],a[1])}})}if(""!==e.addressItem&&(e.geocoder=new google.maps.Geocoder),google.maps.event.addListener(e.map,"click",function(o){var a=o.latLng.lat(),n=o.latLng.lng();jk64plugin_setMarker(e,a,n),""!==e.syncItem&&$s(e.syncItem,a+","+n),""!==e.addressItem&&jk64plugin_getAddress(e,a,n),apex.jQuery("#"+e.regionId).trigger("mapclick",{map:e.map,lat:a,lng:n})}),""!=e.geocodeItem){var t=new google.maps.Geocoder;$("#"+e.geocodeItem).change(function(){jk64plugin_geocode(e,t)})}e.geolocate&&(navigator.geolocation?(apex.debug(e.regionId+" geolocate"),navigator.geolocation.getCurrentPosition(function(o){var a={lat:o.coords.latitude,lng:o.coords.longitude};e.map.panTo(a),e.geolocateZoom&&e.map.setZoom(e.geolocateZoom),apex.jQuery("#"+e.regionId).trigger("geolocate",{map:e.map,lat:a.lat,lng:a.lng})})):apex.debug(e.regionId+" browser does not support geolocation")),apex.jQuery("#"+e.regionId).trigger("maploaded",{map:e.map})}